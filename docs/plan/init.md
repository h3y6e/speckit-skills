# spec-kit to Agent Skills Conversion Plan

## Overview

Convert the Spec-Driven Development (SDD) workflow provided by GitHub's [spec-kit](https://github.com/github/spec-kit) into the [Agent Skills](https://agentskills.io) format. The goal is to make it installable via `npx skills add h3y6e/speckit-skills`.

## Background

- **spec-kit**: An SDD toolkit developed by GitHub. Provides a spec-to-implementation workflow through 9 slash commands via a Python CLI (`specify-cli`)
- **Agent Skills**: An open format developed by Anthropic. A lightweight directory structure centered on `SKILL.md` files that adds knowledge/workflows to AI agents. Supported by 30+ agents including Claude Code, OpenCode, Cursor, and Codex
- **Motivation**: Make the SDD workflow agent-agnostic, remove `.specify/` / Python CLI dependencies, enable one-command installation via `npx skills add`

## Architecture

### Approach

Pin `specify-cli` as a uv git dependency by tag (`v0.1.5`), then use a Python script to process SKILL.md files generated by the `specify` CLI's `--ai-skills` feature and assemble them into Agent Skills format.

```
mise run generate
  |
  +-- 1. specify init (run_specify_init)
  |     +-- --here --ai codex --ai-skills --force --ignore-agent-tools --script sh
  |     -> Generates .agents/skills/speckit-*/SKILL.md (9 files)
  |     -> Expands templates and scripts into .specify/
  |
  +-- 2. Copy & Patch (copy_and_patch_skills)
  |     +-- Delete and recreate skills/
  |     +-- For each skill:
  |     |   +-- Copy SKILL.md
  |     |   +-- Copy templates -> references/
  |     |   +-- Copy scripts -> scripts/
  |     |   +-- Strip metadata frontmatter
  |     |   +-- Apply patches to all files (skill-specific -> common)
  |     +-- See patch.md for patch details
  |
  +-- 3. Verify (verify_output)
        +-- Ensure FORBIDDEN_PATTERNS (`.specify/`, `$ARGUMENTS`) are absent
```

### Why This Approach

- **Build on spec-kit output**: Easier to track upstream changes than writing SKILL.md from scratch
- **Pin via uv git dependency**: No fork needed. Version managed in `pyproject.toml`
- **Python processing**: spec-kit itself is Python-based, and `uv` is already in the toolchain
- **mise task execution**: Locally reproducible, easy to automate in CI

### spec-kit `--ai-skills` Output

Files generated by `specify init --here --ai codex --ai-skills`:

| Destination                         | Content                                      |
| ----------------------------------- | -------------------------------------------- |
| `.agents/skills/speckit-*/SKILL.md` | 9 SKILL.md files (frontmatter + body)        |
| `.specify/scripts/bash/*.sh`        | 5 shell scripts                              |
| `.specify/templates/*.md`           | 6 document templates                         |
| `.specify/memory/constitution.md`   | Copy of constitution template                |
| `.codex/prompts/*.md`               | 9 command templates (retained due to --here) |

Generated SKILL.md files are insufficient as-is -- required patches are defined in [patch.md](./patch.md).

## Design Details

### Removing `.specify/` Dependencies

| Original Path                     | Content            | New Location                                |
| --------------------------------- | ------------------ | ------------------------------------------- |
| `.specify/memory/constitution.md` | Project principles | Moved to `specs/constitution.md`            |
| `.specify/templates/*.md`         | Document templates | Bundled in each skill's `references/`       |
| `.specify/scripts/bash/*.sh`      | Helper scripts     | Bundled in each skill's `scripts/`          |
| `.specify/extensions/`            | Extensions         | Removed (Agent Skills serves the same role) |

### User Project Directory Convention

Required structure in the target user repository:

```
user-project/
└── specs/
    ├── constitution.md              # Project principles
    └── NNN-feature-name/            # Feature artifacts
        ├── spec.md
        ├── plan.md
        ├── tasks.md
        ├── research.md
        ├── data-model.md
        ├── quickstart.md
        ├── contracts/
        └── checklists/
```

### Skill List

| Skill Name              | Original Command         | Description                                          |
| ----------------------- | ------------------------ | ---------------------------------------------------- |
| `speckit-specify`       | `/speckit.specify`       | Create feature spec from natural language            |
| `speckit-clarify`       | `/speckit.clarify`       | Clarify ambiguous spec points with up to 5 questions |
| `speckit-constitution`  | `/speckit.constitution`  | Create or update project principles                  |
| `speckit-plan`          | `/speckit.plan`          | Generate technical implementation plan               |
| `speckit-tasks`         | `/speckit.tasks`         | Generate dependency-aware task breakdown             |
| `speckit-checklist`     | `/speckit.checklist`     | Generate requirements quality checklist              |
| `speckit-implement`     | `/speckit.implement`     | Execute all tasks based on tasks.md                  |
| `speckit-analyze`       | `/speckit.analyze`       | Non-destructive cross-artifact consistency analysis  |
| `speckit-taskstoissues` | `/speckit.taskstoissues` | Convert tasks to GitHub Issues                       |

### Skill Resource Composition

| Skill                   | scripts/                                                | references/                                  |
| ----------------------- | ------------------------------------------------------- | -------------------------------------------- |
| `speckit-specify`       | `common.sh`, `create-new-feature.sh`                    | `spec-template.md`                           |
| `speckit-clarify`       | `common.sh`, `check-prerequisites.sh`                   | (none)                                       |
| `speckit-constitution`  | (none)                                                  | `constitution-template.md`                   |
| `speckit-plan`          | `common.sh`, `setup-plan.sh`, `update-agent-context.sh` | `plan-template.md`, `agent-file-template.md` |
| `speckit-tasks`         | `common.sh`, `check-prerequisites.sh`                   | `tasks-template.md`                          |
| `speckit-checklist`     | `common.sh`, `check-prerequisites.sh`                   | `checklist-template.md`                      |
| `speckit-implement`     | `common.sh`, `check-prerequisites.sh`                   | (none)                                       |
| `speckit-analyze`       | `common.sh`, `check-prerequisites.sh`                   | (none)                                       |
| `speckit-taskstoissues` | `common.sh`, `check-prerequisites.sh`                   | (none)                                       |

## Implementation Steps

1. Create `mise-tasks/generate.py` -- conversion script
2. Run `mise run generate` and verify output
3. Confirm skill detection with `npx skills add ./skills --list`
4. Validate SKILL.md frontmatter for each skill
5. Verify script execute permissions
6. Test skills in a sample project
